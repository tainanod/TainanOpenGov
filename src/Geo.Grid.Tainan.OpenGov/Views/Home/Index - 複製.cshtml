<main ng-app="app" ng-controller="homeController" ng-cloak>
    <div id="homePhotoWrapper" class="homephoto">
        <a href="{{x.WebUrl}}" title="{{x.Title}}" ng-repeat="x in vm.bannerList" ng-attr-target="{{(x.Target) ? '_blank' : '_self'}}" ng-if="x.WebUrl">
            <img ng-src="{{x.PhotoUrl}}" alt="{{x.Title}}"/>
        </a>
        <figure ng-repeat="x in vm.bannerList" title="{{x.Title}}" ng-else>
            <img ng-src="{{x.PhotoUrl}}" alt="{{x.Title}}" />
        </figure>
    </div>
    <div class="home">
        <div class="group-card-wrapper brown">
            <div class="single-card-wrapper">
                <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon1.png")"> 政府資料</div>
                <div class="content-card">
                    <ul id="ulTnod" class="ul-list-card">
                        <li class="li-loading"> <img src="@Url.Content("~/Content/geo/loading/hourglass.svg")"></li>
                    </ul>
                    <a href="http://data.tainan.gov.tw/dataset" target="_blank" class="more">更多</a>
                </div>
            </div>
            <div class="single-card-wrapper">
                <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon2.png")"> 行程公開</div>
                <div class="content-card">
                    <ul id="ulMayor" class="ul-list-card">
                        <li class="li-loading"> <img src="@Url.Content("~/Content/geo/loading/hourglass.svg")"></li>
                    </ul>
                    <a href="http://data.tainan.gov.tw/dataset/calendar/resource/91ba78f9-02e1-4fd8-8981-e1d913f06b01" target="_blank" class="more">更多</a>
                </div>
            </div>
            <div  class="single-card-wrapper">
                <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon3.png")"> 警報告示</div>
                <div class="content-card">
                    <ul id="ulRss" class="ul-list-card">
                        <li class="geo9content">
                            <div class="no" style="line-height: 42px">
                                <i class="icon2"></i>近期尚無<span>災害警報</span>
                            </div>
                        </li>
                    </ul>
                    <a href="http://disaster.tainan.gov.tw/disaster/" target="_blank" class="more">更多</a>
                </div>
            </div>
            <div  class="single-card-wrapper">
                <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon3.png")">&nbsp; </div>
                <div class="content-card">
                    
                </div>
            </div>
        </div>
        <div class="group-card-wrapper red">
            <div class="single-card-wrapper">
                <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon4.png")"> Open 1999</div>
                <a href="http://1999.tainan.gov.tw" target="_blank" class="img"><img src="@Url.Content("~/Content/geo/img/big-icon1.png")"></a>
            </div>
            <div  class="single-card-wrapper">
                <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon5.png")"> 管線圖資</div>
                <a href="http://diggis.tainan.gov.tw/TNRoad/gmap_new/index.asp?flag=1&todayWork=1" target="_blank" class="img"><img src="@Url.Content("~/Content/geo/img/big-icon2.png")"></a>
            </div>
            <div  class="single-card-wrapper">
                <div class="title-card"><i class="fa fa-rocket" aria-hidden="true" style="font-size: 1.6em"></i> 野生台南</div>
                <div class="content-card">
                    <ul id="ulShowcase" class="ul-list-card">
                        <li class="li-loading"> <img src="@Url.Content("~/Content/geo/loading/hourglass.svg")"></li>
                        <li class="home-showcase-li">
                            <figure class="home-showcase-wrapper">
                                <img ng-src="{{vm.target.PhotoUrl}}" alt="{{vm.target.Title}}" />
                                <figcaption>
                                    <a href="@Url.Action("Detail", "ShowCase")/{{vm.target.CaseId}}" title="{{vm.target.Title}}">
                                        <h1>{{vm.target.Title}}</h1>
                                    </a>
                                    <p>{{vm.target.Contents}}</p>
                                </figcaption>
                            </figure>
                        </li>
                        <li class="no-li" style="display: none;">
                            <div class="no" style="line-height: 42px">
                                <i class="icon2"></i>近期尚無 <span>應用展示</span>
                            </div>
                        </li>
                    </ul>
                    <a href="@Url.Action("Index","ShowCase")" class="more">更多</a>
                </div>
            </div>
            @*<div class="icon6" class="single-card-wrapper">
                    <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon6.png")"> 公益台南</div>
                    <a href="#" class="img"><img src="@Url.Content("~/Content/geo/img/big-icon3.png")"></a>
                </div>*@
            @*<div class="single-card-wrapper">
                    <div class="title-card"><img src="http://icons.iconarchive.com/icons/dakirby309/simply-styled/256/Autodesk-Softimage-icon.png"> 測試</div>
                    <div class="content-card">
                        <p>給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用</p>
                        <p>給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用</p>
                        <p>給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用</p>
                        <p>給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用給你個測試使用</p>
                    </div>
                </div>*@
        </div>
        <div class="group-card-wrapper yellow">
            <div class="single-card-wrapper">
                <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon7.png")"> 重大會議</div>
                <div id="dvYoutube" class="geo9content">
                    <div class="no">
                        <i class="icon1"></i>近期尚無<span>重大會議直播</span>
                    </div>
                </div>
                <a href="https://www.youtube.com/channel/UC0HatHjMX8Oo60tILcOnK0g" target="_blank" class="more">更多</a>
            </div>
            <div class="single-card-wrapper">
                <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon8.png")"> 公民論壇</div>
                <div class="content-card">
                    <ul id="ulForum" class="ul-list-card">
                        <li class="li-loading"> <img src="@Url.Content("~/Content/geo/loading/hourglass.svg")"></li>
                    </ul>
                    @Html.ActionLink("更多", "index", "forum", null, new { @class = "more" })

                </div>
            </div>
            <div  class="single-card-wrapper">
                <div class="title-card"><img src="@Url.Content("~/Content/geo/img/icon9.png")"> 市政提案</div>
                <div class="content-card">
                    <div id="dvSuggest" class="no">
                        <i class="icon2"></i>近期尚無<span>市政提案</span>
                    </div>
                    @Html.ActionLink("更多", "Index", "Suggest", null, new { @class = "more" })
                </div>
            </div>
        </div>
    </div>
</main>

<div class="cover" id="dvMayorbox" style="display: none;">
    <a href="javascript:;" onclick="$.fancybox.close();" class="delete"><img src="@Url.Content("~/Content/geo/img/delete.png")" /></a>
    <span class="covertitle"><img src="@Url.Content("~/Content/geo/img/icon2.png")">&nbsp;<span id="mayorTitle"></span></span>
    <div class="coverleft">
        <div id="map_canvas" style="width:380px; height:300px"></div>
    </div>

    <div class="coverright">
        <p>行程事由</p>
        <span id="mayorEvent">仁德區塗庫仔排水周邊截流改善工程現勘</span>
        <p>日期時間</p>
        <span id="mayorTime">2015/04/10 上午09:00:00~上午10:00:00</span>
        <p>主辦單位</p>
        <span id="mayorHolder">水利署</span>
        <p>行程地點</p>
        <span id="mayorLocation">仁德滯洪地(近仁德四街)</span>
    </div>
    <!--<a class="addcalender" href="#">加入行事曆</a>-->
</div>


@section styles{
    <link href="@Url.Content("~/Content/jquery.fancybox.min.css")" rel="stylesheet" />
}


@section scripts
{
    <script src="~/Scripts/jquery.fancybox.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    @*<script src="https://www.gstatic.com/firebasejs/3.7.0/firebase.js"></script>*@
    <script src="@Url.Content("~/Content/geo/slick/slick.min.js")"></script>
    <script src="@Url.Content("~/Scripts/geo/home-index.min.js")"></script>
    <script src='@Url.Content("~/Scripts/angular.min.js")'></script>
    <script src='@Url.Content("~/Scripts/angular-ui/ui-bootstrap-tpls.js")'></script>
    <script src='@Url.Content("~/Scripts/oi.select/select-tpls.js")'></script>
    <script src='@Url.Content("~/Scripts/App/Home/home.app.js")'></script>
    <script src='@Url.Content("~/Scripts/App/Home/home.service.js")'></script>
    <script src='@Url.Content("~/Scripts/App/Home/home.controller.js")'></script>
    <script src="~/Scripts/vue.js"></script>
    <script src="~/Scripts/vue-resource.js"></script>
    <script src="~/Scripts/Sortable.js"></script>
    <script src="~/Scripts/vuedraggable.js"></script>
    <script>
        
        var $window = $(window);

        function forumTagPosition() {
            $('#ulForum>li').each(function (i) {
                var forumLiWidth = $('#ulForum>li').eq(i).width();
                var forumSubjectTitleWidth = $('.subject-title').eq(i).width() + 10;
                var forumLinkWrapperWidth = forumLiWidth - forumSubjectTitleWidth;

                $('.link-title-wrapper').width(forumLinkWrapperWidth);

                var $questionTag = $('.question-tag').eq(i);
                var tagWidth = $questionTag.width();
                var forumLinkTitleWidth = $('.link-title').eq(i).width() + 40;


                if ((forumLinkWrapperWidth - forumLinkTitleWidth) < tagWidth && $questionTag.prev().prop('tagName') !== 'BR') {
                    $questionTag.before('<br>');
                } else if ((forumLinkWrapperWidth - forumLinkTitleWidth) > tagWidth && $questionTag.prev().prop('tagName') == 'BR') {
                    $questionTag.prev().remove();
                }

            })

        }
        $window.load(function () {
            forumTagPosition();
            $window.resize(function () {
                forumTagPosition();
            })

        })
    </script>

}
